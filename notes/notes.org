#+title: Karachentsev List notes
#+bibliography: "../My Library/My Library.bib"
#+PROPERTY: header-args :lang python :eval python :exports results :tangle final.py :results output drawer :session main

This list contains measurements from the galaxies in the Local Cosmological Volume (LCV), and the last update of data is on 2023-11-09. I downloaded the database from [cite:@karachentsevUPDATEDNEARBYGALAXY2013]

* Original data set

The data I will use for this project come from the Karachentsev  catalog (2022-12-02), which is an updated version of the list used in Kroupa et al. 2020
From the list I use the tables "Catalog of Nearby Galaxies", "Global Parameters of the Nearby Galaxies" and "List of the nearby galaxies with measured SFR"

#+begin_src python

import numpy as np
from astropy.io import ascii
from astropy.coordinates import SkyCoord, ICRS, Galactic, FK4, FK5, Angle
from astropy.table import Table, QTable, join, hstack, vstack, unique, Column, MaskedColumn, setdiff
from astropy.utils.masked import Masked
from astropy.time import Time
import astropy.units as u
from astropy.utils.diff import report_diff_values
import glob as glob
import sys

file_pattern = "../list/lvg_table*.dat"

# Use glob to find all matching files
file_paths = sorted(glob.glob(file_pattern))

dq = []  # Create an empty list to store QTables

for file_path in file_paths:
    table = QTable(ascii.read(file_path, format="mrt"),masked=True)
    dq.append(table)
#+end_src

#+RESULTS:
:results:
:end:


#+begin_src python

nm = []
nm = ["cat", "param", "magn", "vel", "kin", "dist", "sfr"]

# Automatically associate the names with the QTables
for i in range(len(nm)):
    globals()[nm[i]] = dq[i]
#+end_src

#+RESULTS:
:results:
:end:

** Table 3

I will need the colors, so i think the best way is to create tables for each filter and then join them.

#+begin_src python :results value

filters = magn.group_by("Filter")

keys = filters.groups.keys["Filter"]
indices = filters.groups.indices

magn_table = QTable()
dcolor = []
pain = 0
n = 0
print(indices,"\n", keys,"\n")
for ind in indices[1:]:
    magn_table = filters[pain:ind]
    magn_table.rename_column("l_mag", f"l_mag_{keys[n]}")
    magn_table.rename_column("mag", f"mag_{keys[n]}")
    magn_table.rename_column("e_mag", f"e_mag_{keys[n]}")
    magn_table.rename_column("r_mag", f"r_mag_{keys[n]}")
    magn_table.remove_column("Filter")
    print("\n********************",keys[n],"********************\n",magn_table.info, )
    pain = ind
    n+=1
    dcolor.append(magn_table)
colors = QTable(dcolor[0])

for dcolor_item in dcolor[1:]:
    colors = QTable(join(colors, dcolor_item, keys="Name", join_type="outer"))

colors.info
#+end_src

#+RESULTS:
:results:
<QTable length=1441>
   name    dtype  unit            description                 class      n_bad
--------- ------- ---- ---------------------------------- -------------- -----
     Name   str18      Galaxy name in well-known catalogs   MaskedColumn     0
  l_mag_B    str1                       Limit flag on mag   MaskedColumn  1441
    mag_B float64  mag   Apparent magnitude in Filter (1) MaskedQuantity     9
  e_mag_B float64  mag                   Error in mag (2) MaskedQuantity  1256
  r_mag_B   str19           Reference for mag observation   MaskedColumn     9
l_mag_FUV    str1                       Limit flag on mag   MaskedColumn  1109
  mag_FUV float64  mag   Apparent magnitude in Filter (1) MaskedQuantity   315
e_mag_FUV float64  mag                   Error in mag (2) MaskedQuantity   737
r_mag_FUV   str19           Reference for mag observation   MaskedColumn   315
 l_mag_HI    str1                       Limit flag on mag   MaskedColumn  1231
   mag_HI float64  mag   Apparent magnitude in Filter (1) MaskedQuantity   496
 e_mag_HI float64  mag                   Error in mag (2) MaskedQuantity  1293
 r_mag_HI   str19           Reference for mag observation   MaskedColumn   496
 l_mag_Ha    str1                       Limit flag on mag   MaskedColumn  1311
   mag_Ha float64  mag   Apparent magnitude in Filter (1) MaskedQuantity   705
 e_mag_Ha float64  mag                   Error in mag (2) MaskedQuantity   767
 r_mag_Ha   str19           Reference for mag observation   MaskedColumn   705
 l_mag_Ks    str1                       Limit flag on mag   MaskedColumn  1441
   mag_Ks float64  mag   Apparent magnitude in Filter (1) MaskedQuantity  1081
 e_mag_Ks float64  mag                   Error in mag (2) MaskedQuantity  1095
 r_mag_Ks   str19           Reference for mag observation   MaskedColumn  1081
:end:

** Merging the tables

*** Fixing the conflicts

**** A26 and AB
#+begin_src python
param.rename_column("a26", "A26")
param.rename_column("AB","AB_int")
#+end_src

#+RESULTS:
:results:
:end:

**** W50
#+begin_src python

identical = report_diff_values(cat["Name","W50"], kin["Name", "W50"])
print(identical)
#+end_src

#+RESULTS:
:results:
          Name      W50
                   km / s
     ------------- ------
         AGC102728   21.0
          UGC12894   34.0
         PGC000083   32.0
               WLM   53.0
         And XVIII   23.0
  a>     PAndAS-03    ———
  a>     PAndAS-04    ———
  a>     PAndAS-05    ———
        ESO409-015   53.0
         AGC748778   16.0
            And XX   17.0
          UGC00064   60.0
        ESO349-031   30.0
  a>     dw0009-25    ———
           NGC0024  213.0
  a>     dw0010-25    ———
           NGC0045  172.0
           PiscesA   22.0
           NGC0055  169.0
           NGC0059   50.0
  a>    NGC 55-dw1    ———
        ESO410-005   23.0
     LV J0015-3825   59.0
  b>       And XIX   11.0
  b>        IC0010   62.0
  b>        JKB129   32.0
  b>      And XXVI   20.0
  b>         Cetus   40.0
  b>    ESO294-010   23.0
               ...    ...
  b>     AGC322463   23.0
  b>       NGC7462  183.0
  b>       NGC7640  238.0
  b>      UGC12588   90.0
           UGCA438   35.0
          Cas dSph   29.0
        ESO347-017   69.0
           Pegasus   23.0
            DDO217  117.0
            IC5332  102.0
     LV J2335-3713   29.0
           NGC7713  182.0
          UGC12713   95.0
  a>     Phoenix 2    ———
         PGC680341   48.0
           UGCA442   94.0
             KKH98   21.0
        ESO348-009   85.0
          Peg dSph   22.0
        ESO149-003   39.0
           And XXI   17.0
        Tucana III    4.0
  a>     PAndAS-01    ———
           NGC7793  172.0
  a>     PAndAS-02    ———
  a>     PGC704814    ———
          And XXIX   13.0
  a> Length = 1441 rows
   ?           ^^^
  b> Length = 816 rows
   ?          + ^
False
:end:

But, according to the metadata of table 1 "Note (9): The main source of W50 data was LEDA, as well as the HIPASS and ALFALFA surveys. The references to individual W50 measurements are presented in Table 5 and the LV database"

So I can drop the column of table 1 and only keep the table 5 W50

#+begin_src python
cat.remove_column("W50")
#+end_src

**** BMag


#+begin_src python

identical = report_diff_values(param["Name","BMag"], sfr["Name", "BMag"], rtol = 4.5, atol = 4.5)
print(identical)
#+end_src

#+RESULTS:
:results:
  a>      Name      BMag
  b>      Name      BMag
   ?                    +
  a>                mag
  b>                mag
   ?                    +
  a> ------------- -----
  b> ------------- ------
   ?                    +
  a>     AGC102728 -10.4
  b>     AGC102728 -10.44
   ?                    +
  a>      UGC12894 -13.5
  b>      UGC12894 -13.45
   ?                   +
  a>     PGC000083 -12.3
  b>     PGC000083 -12.32
   ?                    +
  a>           WLM -14.1
   ?                   ^
  b>           WLM -14.09
   ?                   ^^
  a>     And XVIII  -8.7
  b>     And XVIII  -8.73
   ?                    +
  a>     PAndAS-03  -3.6
  b>     PAndAS-03  -3.56
   ?                   +
  a>     PAndAS-04  -6.6
  b>     PAndAS-04  -6.61
   ?                    +
  a>     PAndAS-05  -4.5
  b>     PAndAS-05   -4.5
   ?                +
  a>    ESO409-015 -14.6
  b>    ESO409-015 -14.62
   ?                    +
  a>     AGC748778 -10.4
   ?                   ^
  b>     AGC748778 -10.35
   ?                   ^^
  a>        And XX  -5.8
   ?                   ^
  b>        And XX  -5.77
   ?                   ^^
  a>      UGC00064 -14.3
   ?                   ^
  b>      UGC00064 -14.25
   ?                   ^^
  a>    ESO349-031 -11.9
   ?                   ^
  b>    ESO349-031 -11.87
   ?                   ^^
  a>     dw0009-25  -7.7
   ?                   ^
  b>     dw0009-25  -7.69
   ?                   ^^
  a>       NGC0024 -17.7
   ?                   ^
  b>       NGC0024 -17.66
   ?                   ^^
  a>     dw0010-25 -11.2
   ?                   ^
  b>     dw0010-25 -11.15
   ?                   ^^
  a>       NGC0045 -17.8
  b>       NGC0045 -17.82
   ?                    +
  a>       PiscesA -10.7
  b>       PiscesA  -10.7
   ?               +
  a>       NGC0055 -18.8
   ?                   ^
  b>       NGC0055 -18.76
   ?                   ^^
  a>       NGC0059 -15.6
   ?                   ^
  b>       NGC0059 -15.57
   ?                   ^^
  a>    NGC 55-dw1  -7.4
  a>    ESO410-005 -11.6
   ?                   ^
  b>    ESO410-005 -11.59
   ?                   ^^
  a> LV J0015-3825 -11.1
   ?                   ^
  b> LV J0015-3825 -11.08
   ?                   ^^
  b>       And XIX  -9.62
  a>           ...   ...
  b>           ...    ...
   ?                 +
  b>       NGC7462 -18.15
  b>       ApplesI  -8.25
  b>       NGC7640  -19.3
  b>      UGC12588 -16.79
  a>       UGCA438 -12.9
  b>       UGCA438  -12.9
   ?               +
  a>      Cas dSph -11.8
   ?                   ^
  b>      Cas dSph -11.76
   ?                   ^^
  a>    ESO347-017 -15.5
  b>    ESO347-017 -15.45
   ?                   +
  a>       Pegasus -12.0
  b>       Pegasus  -12.0
   ?               +
  a>        DDO217 -17.7
  b>        DDO217 -17.67
   ?                   +
  a>        IC5332 -18.9
  b>        IC5332  -18.9
   ?               +
  a> LV J2335-3713 -12.8
  a>       NGC7713 -18.5
  b>       NGC7713 -18.45
   ?                   +
  a>      UGC12713 -16.0
   ?                 ^ ^
  b>      UGC12713 -15.95
   ?                 ^ ^^
  a>     Phoenix 2  -2.2
  a>     PGC680341 -12.2
  b>     PGC680341 -12.24
   ?                    +
  a>       UGCA442 -14.7
  b>       UGCA442 -14.71
   ?                    +
  a>         KKH98 -10.9
  b>         KKH98 -10.89
   ?                   +
  a>    ESO348-009 -15.6
   ?                   ^
  b>    ESO348-009 -15.55
   ?                   ^^
  a>      Peg dSph -10.7
  b>      Peg dSph -10.67
   ?                   +
  a>    ESO149-003 -14.2
  b>    ESO149-003 -14.24
   ?                    +
  a>       And XXI  -8.5
   ?                   ^
  b>       And XXI  -8.47
   ?                   ^^
  a>    Tucana III  -1.7
  a>     PAndAS-01  -7.0
   ?                  --
  b>     PAndAS-01  -6.97
   ?                 +++
  a>       NGC7793 -18.3
  b>       NGC7793 -18.34
   ?                    +
  a>     PAndAS-02  -6.2
  b>     PAndAS-02  -6.24
   ?                    +
  a>     PGC704814 -11.4
  a>      And XXIX  -7.5
  b>      And XXIX  -7.52
   ?                    +
  a> Length = 1441 rows
   ?           ^^^
  b> Length = 1257 rows
   ?           ^^^
False
:end:


*** Merging


#+begin_src python
# Find the index of "magn" in the list
index_to_replace = nm.index("magn")

# Replace "magn" with "color"
nm[index_to_replace] = "colors"
#+end_src

#+RESULTS:
:results:
:end:

#+begin_src python
dtables = []


for i in range(len(nm)):
    lists = QTable(globals()[nm[i]])
    dtables.append(lists)
#+end_src

#+RESULTS:
:results:
[0;33mWARNING[0m: column logKLum has a unit but is kept as a MaskedColumn as an attempt to convert it to Quantity failed with:
UnitTypeError("MaskedQuantity instances require normal units, not <class 'astropy.units.function.logarithmic.DexUnit'> instances.") [astropy.table.table]
[0;33mWARNING[0m: column logM26 has a unit but is kept as a MaskedColumn as an attempt to convert it to Quantity failed with:
UnitTypeError("MaskedQuantity instances require normal units, not <class 'astropy.units.function.logarithmic.DexUnit'> instances.") [astropy.table.table]
[0;33mWARNING[0m: column logMHI has a unit but is kept as a MaskedColumn as an attempt to convert it to Quantity failed with:
UnitTypeError("MaskedQuantity instances require normal units, not <class 'astropy.units.function.logarithmic.DexUnit'> instances.") [astropy.table.table]
:end:

#+begin_src python

dt = dtables[0]
for data in dtables[1:]:
    dt = QTable(join(dt, data, join_type="outer"))
print(dt.info)
#+end_src

#+RESULTS:
:results:
:end:

** IDEA mapping with Color, type of galaxy, SFR, Velocity
** IDEA machine learning
*** Bands (FUV)
*** missing SFR
***
** [?] What is the W50 velocity



